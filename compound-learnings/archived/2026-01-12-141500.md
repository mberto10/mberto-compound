## Session Context
- Date: 2026-01-12
- Plugins used: work-toolkit (add-kw-update command)
- Focus: User explicitly specified "KW02" in arguments but model ignored it and used system date (KW03)

## Summary
User invoked `/add-kw-update` with arguments that clearly included "KW02" in the text. The model blindly ran `date +%V` to get the current week (KW03) instead of parsing the user's explicit KW specification from the input. User had to interrupt and correct. This is a **frontier-shifting fix** - parsing explicit user intent prevents repeated friction across all future invocations.

## Learnings

### Rules
- When user input explicitly contains a KW number (e.g., "KW02", "KW 02", "KW2"), use that value instead of computing from system date. User intent > system defaults. [src:2026-01-12T1415Z__add-kw-update-kw-parsing] [type:rule]

### Fixes
- The add-kw-update command workflow must parse the arguments for an explicit KW number BEFORE falling back to `date +%V`. Pattern: look for /KW\s?(\d{1,2})/i in the input. [src:2026-01-12T1415Z__add-kw-update-kw-parsing] [type:fix]

### Feature Requests
- None identified this session.

## Proposed Changes

### work-toolkit: add-kw-update command
- **File:** `/home/runner/.claude/plugins/cache/mberto-compound/work-toolkit/0.1.0/commands/add-kw-update.md`
- **Change type:** update
- **Description:** Modify the workflow to add a step BEFORE "Get Current KW" that parses the user's arguments for an explicit KW number. The new logic should be:
  1. Check if arguments contain a KW pattern (KW02, KW 02, KW2, etc.)
  2. If found, extract that number and use it
  3. If NOT found, fall back to `date +%V`
- **Priority:** high

### Proposed new workflow step (to insert after "Find the Epic"):

```markdown
### 2. Determine Target KW

**Priority: User-specified KW > System date**

First, check if the user explicitly specified a KW in their arguments:
- Look for patterns: `KW02`, `KW 02`, `KW2`, `kw02`, etc.
- Regex: `/KW\s?0?(\d{1,2})/i`

If found, use that KW number. If not found, get current week:
```bash
date +%V
```

**Rationale:** Users may be adding updates for past weeks (catching up) or future weeks (planning). Never override explicit user intent with system defaults.
```

## Raw Observations

- The command examples in the docs don't show KW specification, which may have contributed to the model not expecting it
- The argument-hint shows `<project_name> <section> <content>` but doesn't mention optional KW override
- User frustration level was high ("FUCKING") indicating this is a repeated pain point or particularly jarring UX failure
- The author issue mentioned by user (comment shows wrong author) is likely a YouTrack API authentication issue, not something the command can fix - the API posts as whoever's token is configured

## Classification

| Learning | Frontier Position | Selection Pressure | Priority |
|----------|-------------------|-------------------|----------|
| Parse explicit KW from input | Frontier-shifting (improves capability for all KW operations) | Real friction (user had to interrupt) | HIGH |

## Next Steps

Run `/compound:consolidate` in your workstation to implement these changes to the work-toolkit plugin.
